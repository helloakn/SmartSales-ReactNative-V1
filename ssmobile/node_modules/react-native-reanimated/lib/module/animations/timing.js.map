{"version":3,"sources":["timing.js"],"names":["cond","sub","divide","multiply","add","block","set","greaterOrEq","proc","internalTiming","clock","time","frameTime","position","finished","toValue","duration","nextProgress","progress","newFrameTime","state","config","distanceLeft","fullDistance","startPosition","nextPosition","lastTime","easing"],"mappings":"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","sourcesContent":["import {\n  cond,\n  sub,\n  divide,\n  multiply,\n  add,\n  block,\n  set,\n  greaterOrEq,\n  proc,\n} from '../base';\n\nconst internalTiming = proc(function(\n  clock,\n  time,\n  frameTime,\n  position,\n  finished,\n  toValue,\n  duration,\n  nextProgress,\n  progress,\n  newFrameTime\n) {\n  const state = {\n    time,\n    finished,\n    frameTime,\n    position,\n  };\n\n  const config = {\n    duration,\n    toValue,\n  };\n\n  const distanceLeft = sub(config.toValue, state.position);\n  const fullDistance = divide(distanceLeft, sub(1, progress));\n  const startPosition = sub(config.toValue, fullDistance);\n  const nextPosition = add(startPosition, multiply(fullDistance, nextProgress));\n\n  return block([\n    cond(\n      greaterOrEq(newFrameTime, config.duration),\n      [set(state.position, config.toValue), set(state.finished, 1)],\n      set(state.position, nextPosition)\n    ),\n    set(state.frameTime, newFrameTime),\n    set(state.time, clock),\n  ]);\n});\n\nexport default function(clock, state, config) {\n  if (config.duration === 0) {\n    // when duration is zero we end the timing immediately\n    return block([set(state.position, config.toValue), set(state.finished, 1)]);\n  }\n  const lastTime = cond(state.time, state.time, clock);\n  const newFrameTime = add(state.frameTime, sub(clock, lastTime));\n  const nextProgress = config.easing(divide(newFrameTime, config.duration));\n  const progress = config.easing(divide(state.frameTime, config.duration));\n  return internalTiming(\n    clock,\n    state.time,\n    state.frameTime,\n    state.position,\n    state.finished,\n    config.toValue,\n    config.duration,\n    nextProgress,\n    progress,\n    newFrameTime\n  );\n}\n"]}